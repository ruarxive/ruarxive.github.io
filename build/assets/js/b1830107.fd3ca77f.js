"use strict";(globalThis.webpackChunkrussian_national_digital_archive_ruarxive=globalThis.webpackChunkrussian_national_digital_archive_ruarxive||[]).push([[8921],{7043:(r,n,e)=>{e.r(n),e.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"guides/custom-workflows","title":"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0445 workflow \u0434\u043b\u044f \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u0438","description":"\u0420\u0443\u043a\u043e\u0432\u043e\u0434\u0441\u0442\u0432\u043e \u043f\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u0438, \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u044e\u0449\u0438\u0445 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432 Ruarxive \u0432 \u0435\u0434\u0438\u043d\u044b\u0439 workflow.","source":"@site/kb/guides/custom-workflows.md","sourceDirName":"guides","slug":"/guides/custom-workflows","permalink":"/kb/guides/custom-workflows","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"\u042d\u043a\u0441\u0442\u0440\u0435\u043d\u043d\u0430\u044f \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f: \u043a\u043e\u0433\u0434\u0430 \u0441\u0447\u0435\u0442 \u0438\u0434\u0435\u0442 \u043d\u0430 \u0447\u0430\u0441\u044b","permalink":"/kb/guides/emergency-archiving"},"next":{"title":"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430 Ruarxive","permalink":"/kb/resources/statistics"}}');var o=e(4848),i=e(8453);const s={sidebar_position:4},l="\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0445 workflow \u0434\u043b\u044f \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u0438",a={},c=[{value:"\u0417\u0430\u0447\u0435\u043c \u043d\u0443\u0436\u043d\u044b \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0435 workflow",id:"\u0437\u0430\u0447\u0435\u043c-\u043d\u0443\u0436\u043d\u044b-\u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0435-workflow",level:2},{value:"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 workflow",id:"\u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430-workflow",level:2},{value:"\u0411\u0430\u0437\u043e\u0432\u044b\u0439 workflow",id:"\u0431\u0430\u0437\u043e\u0432\u044b\u0439-workflow",level:3},{value:"\u041f\u0440\u0438\u043c\u0435\u0440\u044b workflow",id:"\u043f\u0440\u0438\u043c\u0435\u0440\u044b-workflow",level:2},{value:"Workflow 1: \u041a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u043d\u044b\u0439 \u0432\u0435\u0431-\u0440\u0435\u0441\u0443\u0440\u0441",id:"workflow-1-\u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u043d\u044b\u0439-\u0432\u0435\u0431-\u0440\u0435\u0441\u0443\u0440\u0441",level:3},{value:"Workflow 2: \u0421\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0435\u0442\u0438 \u0438 \u0432\u0435\u0431-\u0441\u0430\u0439\u0442",id:"workflow-2-\u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435-\u0441\u0435\u0442\u0438-\u0438-\u0432\u0435\u0431-\u0441\u0430\u0439\u0442",level:3},{value:"Workflow 3: \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0440\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u0430\u044f \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f",id:"workflow-3-\u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f-\u0440\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u0430\u044f-\u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f",level:3},{value:"\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043e\u0448\u0438\u0431\u043e\u043a",id:"\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430-\u043e\u0448\u0438\u0431\u043e\u043a",level:2},{value:"Retry \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c",id:"retry-\u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c",level:3},{value:"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439",id:"\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430-\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439",level:3},{value:"\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0438 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",id:"\u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433-\u0438-\u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",level:2},{value:"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",id:"\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435-\u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",level:3},{value:"\u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438",id:"\u043b\u0443\u0447\u0448\u0438\u0435-\u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438",level:2},{value:"\u0421\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b",id:"\u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435-\u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b",level:2}];function d(r){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...r.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435-\u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0445-workflow-\u0434\u043b\u044f-\u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u0438",children:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0445 workflow \u0434\u043b\u044f \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u0438"})}),"\n",(0,o.jsx)(n.p,{children:"\u0420\u0443\u043a\u043e\u0432\u043e\u0434\u0441\u0442\u0432\u043e \u043f\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u0438, \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u044e\u0449\u0438\u0445 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432 Ruarxive \u0432 \u0435\u0434\u0438\u043d\u044b\u0439 workflow."}),"\n",(0,o.jsx)(n.h2,{id:"\u0437\u0430\u0447\u0435\u043c-\u043d\u0443\u0436\u043d\u044b-\u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0435-workflow",children:"\u0417\u0430\u0447\u0435\u043c \u043d\u0443\u0436\u043d\u044b \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0435 workflow"}),"\n",(0,o.jsx)(n.p,{children:"\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b \u0440\u0435\u0448\u0430\u044e\u0442 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u0447\u0438, \u043d\u043e \u0440\u0435\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u044b \u0447\u0430\u0441\u0442\u043e \u0442\u0440\u0435\u0431\u0443\u044e\u0442:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"\u041a\u043e\u043c\u0431\u0438\u043d\u0430\u0446\u0438\u0438 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432"}),": \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0434\u043b\u044f \u043e\u0434\u043d\u043e\u0433\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u0430"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438"}),": \u0417\u0430\u043f\u0443\u0441\u043a \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0431\u0435\u0437 \u0440\u0443\u0447\u043d\u043e\u0433\u043e \u0432\u043c\u0435\u0448\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u0430"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445"}),": \u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0436\u0434\u0443 \u044d\u0442\u0430\u043f\u0430\u043c\u0438"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430"}),": \u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430 \u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043e\u0448\u0438\u0431\u043e\u043a"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"\u041f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u043c\u043e\u0441\u0442\u0438"}),": \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u043c\u043d\u043e\u0433\u043e\u043a\u0440\u0430\u0442\u043d\u043e"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"\u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430-workflow",children:"\u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430 workflow"}),"\n",(0,o.jsx)(n.h3,{id:"\u0431\u0430\u0437\u043e\u0432\u044b\u0439-workflow",children:"\u0411\u0430\u0437\u043e\u0432\u044b\u0439 workflow"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502   \u0410\u043d\u0430\u043b\u0438\u0437    \u2502 \u2192 \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0440\u0435\u0441\u0443\u0440\u0441\u0430\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n      \u2193\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502  \u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u2502 \u2192 \u0412\u044b\u0431\u043e\u0440 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0438 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0438\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n      \u2193\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502  \u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f  \u2502 \u2192 \u0417\u0430\u043f\u0443\u0441\u043a \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n      \u2193\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502  \u0412\u0435\u0440\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u2502 \u2192 \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0446\u0435\u043b\u043e\u0441\u0442\u043d\u043e\u0441\u0442\u0438\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n      \u2193\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502  \u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430  \u2502 \u2192 \u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n      \u2193\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502   \u0425\u0440\u0430\u043d\u0435\u043d\u0438\u0435  \u2502 \u2192 \u0423\u043f\u0430\u043a\u043e\u0432\u043a\u0430 \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,o.jsx)(n.h2,{id:"\u043f\u0440\u0438\u043c\u0435\u0440\u044b-workflow",children:"\u041f\u0440\u0438\u043c\u0435\u0440\u044b workflow"}),"\n",(0,o.jsx)(n.h3,{id:"workflow-1-\u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u043d\u044b\u0439-\u0432\u0435\u0431-\u0440\u0435\u0441\u0443\u0440\u0441",children:"Workflow 1: \u041a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u043d\u044b\u0439 \u0432\u0435\u0431-\u0440\u0435\u0441\u0443\u0440\u0441"}),"\n",(0,o.jsx)(n.p,{children:"\u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f \u0441\u0430\u0439\u0442\u0430 \u0441 WordPress, API \u0438 \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u043c\u0438 \u0444\u0430\u0439\u043b\u0430\u043c\u0438."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\r\n# archive-complex-site.sh\r\n\r\nset -e  # \u041e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u043f\u0440\u0438 \u043e\u0448\u0438\u0431\u043a\u0435\r\n\r\nSITE_URL="$1"\r\nOUTPUT_DIR="./archive-$(date +%Y%m%d)"\r\nPROJECT_NAME="complex-site"\r\n\r\n# \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b\r\nmkdir -p "$OUTPUT_DIR"/{wordpress,api,static,logs}\r\n\r\necho "=== \u042d\u0442\u0430\u043f 1: \u0410\u043d\u0430\u043b\u0438\u0437 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b ==="\r\n# \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 WordPress API\r\nif curl -s "$SITE_URL/wp-json/wp/v2/" > /dev/null 2>&1; then\r\n  echo "\u2713 WordPress API \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d"\r\n  HAS_WORDPRESS=true\r\nelse\r\n  echo "\u2717 WordPress API \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d"\r\n  HAS_WORDPRESS=false\r\nfi\r\n\r\n# \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 REST API\r\nif curl -s "$SITE_URL/api/v1/health" > /dev/null 2>&1; then\r\n  echo "\u2713 REST API \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d"\r\n  HAS_API=true\r\nelse\r\n  echo "\u2717 REST API \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d"\r\n  HAS_API=false\r\nfi\r\n\r\necho "=== \u042d\u0442\u0430\u043f 2: \u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f WordPress ==="\r\nif [ "$HAS_WORDPRESS" = true ]; then\r\n  wparc "$SITE_URL" \\\r\n    --output "$OUTPUT_DIR/wordpress" \\\r\n    2>&1 | tee "$OUTPUT_DIR/logs/wordpress.log"\r\n  \r\n  if [ $? -eq 0 ]; then\r\n    echo "\u2713 WordPress \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"\r\n  else\r\n    echo "\u2717 \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u0438 WordPress"\r\n    exit 1\r\n  fi\r\nfi\r\n\r\necho "=== \u042d\u0442\u0430\u043f 3: \u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f API ==="\r\nif [ "$HAS_API" = true ]; then\r\n  # \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 apibackuper\r\n  cat > "$OUTPUT_DIR/api_config.yaml" << EOF\r\nproject:\r\n  name: $PROJECT_NAME-api\r\nrequest:\r\n  url: "$SITE_URL/api/v1/data"\r\n  method: GET\r\n  params:\r\n    page: 1\r\n    per_page: 100\r\n  iterator:\r\n    param: page\r\n    start: 1\r\n    step: 1\r\nrate_limit:\r\n  enabled: true\r\n  requests_per_second: 5\r\nstorage:\r\n  type: zip\r\n  file: "$OUTPUT_DIR/api/api_data.zip"\r\nEOF\r\n\r\n  apibackuper run full -p "$PROJECT_NAME-api" \\\r\n    2>&1 | tee "$OUTPUT_DIR/logs/api.log"\r\n  \r\n  if [ $? -eq 0 ]; then\r\n    echo "\u2713 API \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"\r\n  else\r\n    echo "\u2717 \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u0438 API"\r\n  fi\r\nfi\r\n\r\necho "=== \u042d\u0442\u0430\u043f 4: \u0421\u043a\u0430\u0447\u0438\u0432\u0430\u043d\u0438\u0435 \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0444\u0430\u0439\u043b\u043e\u0432 ==="\r\n# \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 filegetter\r\ncat > "$OUTPUT_DIR/filegetter_config.yaml" << EOF\r\npatterns:\r\n  - url: "$SITE_URL/files/{id}.pdf"\r\n    range:\r\n      start: 1\r\n      end: 1000\r\noutput:\r\n  directory: "$OUTPUT_DIR/static"\r\ndownload:\r\n  threads: 5\r\n  retries: 3\r\nEOF\r\n\r\nfilegetter --config "$OUTPUT_DIR/filegetter_config.yaml" \\\r\n  2>&1 | tee "$OUTPUT_DIR/logs/filegetter.log"\r\n\r\necho "=== \u042d\u0442\u0430\u043f 5: \u0412\u0435\u0440\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f ==="\r\n# \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0430\u043b\u0438\u0447\u0438\u044f \u0444\u0430\u0439\u043b\u043e\u0432\r\nif [ -f "$OUTPUT_DIR/wordpress/posts.json" ]; then\r\n  POSTS_COUNT=$(jq \'length\' "$OUTPUT_DIR/wordpress/posts.json")\r\n  echo "\u2713 WordPress: $POSTS_COUNT \u043f\u043e\u0441\u0442\u043e\u0432"\r\nfi\r\n\r\nif [ -f "$OUTPUT_DIR/api/api_data.zip" ]; then\r\n  ZIP_SIZE=$(du -h "$OUTPUT_DIR/api/api_data.zip" | cut -f1)\r\n  echo "\u2713 API: \u0430\u0440\u0445\u0438\u0432 \u0440\u0430\u0437\u043c\u0435\u0440\u043e\u043c $ZIP_SIZE"\r\nfi\r\n\r\necho "=== \u042d\u0442\u0430\u043f 6: \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0444\u0438\u043d\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0430\u0440\u0445\u0438\u0432\u0430 ==="\r\ntar -czf "${PROJECT_NAME}-$(date +%Y%m%d).tar.gz" "$OUTPUT_DIR"\r\necho "\u2713 \u0424\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0430\u0440\u0445\u0438\u0432 \u0441\u043e\u0437\u0434\u0430\u043d: ${PROJECT_NAME}-$(date +%Y%m%d).tar.gz"\r\n\r\necho "=== Workflow \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d ==="\n'})}),"\n",(0,o.jsx)(n.h3,{id:"workflow-2-\u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435-\u0441\u0435\u0442\u0438-\u0438-\u0432\u0435\u0431-\u0441\u0430\u0439\u0442",children:"Workflow 2: \u0421\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0435\u0442\u0438 \u0438 \u0432\u0435\u0431-\u0441\u0430\u0439\u0442"}),"\n",(0,o.jsx)(n.p,{children:"\u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f Telegram \u043a\u0430\u043d\u0430\u043b\u0430, Instagram \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 \u0438 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0432\u0435\u0431-\u0441\u0430\u0439\u0442\u0430."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\r\n# archive-social-media-workflow.py\r\n\r\nimport subprocess\r\nimport json\r\nimport os\r\nfrom datetime import datetime\r\nfrom pathlib import Path\r\n\r\nclass ArchiveWorkflow:\r\n    def __init__(self, project_name, output_dir):\r\n        self.project_name = project_name\r\n        self.output_dir = Path(output_dir)\r\n        self.output_dir.mkdir(parents=True, exist_ok=True)\r\n        self.logs = []\r\n    \r\n    def log(self, message):\r\n        print(f"[{datetime.now()}] {message}")\r\n        self.logs.append(f"[{datetime.now()}] {message}")\r\n    \r\n    def run_command(self, cmd, description):\r\n        self.log(f"\u0417\u0430\u043f\u0443\u0441\u043a: {description}")\r\n        try:\r\n            result = subprocess.run(\r\n                cmd,\r\n                shell=True,\r\n                capture_output=True,\r\n                text=True,\r\n                check=True\r\n            )\r\n            self.log(f"\u2713 {description} \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d \u0443\u0441\u043f\u0435\u0448\u043d\u043e")\r\n            return result.stdout\r\n        except subprocess.CalledProcessError as e:\r\n            self.log(f"\u2717 \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 {description}: {e.stderr}")\r\n            raise\r\n    \r\n    def archive_telegram(self, channel_name, config_file):\r\n        """\u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f Telegram \u043a\u0430\u043d\u0430\u043b\u0430"""\r\n        output_path = self.output_dir / "telegram"\r\n        output_path.mkdir(exist_ok=True)\r\n        \r\n        cmd = f"tgarc download --target {channel_name} --output {output_path} --config {config_file}"\r\n        self.run_command(cmd, f"\u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f Telegram \u043a\u0430\u043d\u0430\u043b\u0430 {channel_name}")\r\n        \r\n        # \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\r\n        messages_file = output_path / "messages.jsonl"\r\n        if messages_file.exists():\r\n            count = sum(1 for _ in open(messages_file))\r\n            self.log(f"  \u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439: {count}")\r\n    \r\n    def archive_instagram(self, username, output_path):\r\n        """\u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f Instagram (\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f data-take-out)"""\r\n        # \u0417\u0434\u0435\u0441\u044c \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b \u0434\u043b\u044f Instagram\r\n        self.log(f"\u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f Instagram \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 {username}")\r\n        # \u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432\r\n    \r\n    def archive_website(self, url, method="wget"):\r\n        """\u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f \u0432\u0435\u0431-\u0441\u0430\u0439\u0442\u0430"""\r\n        output_path = self.output_dir / "website"\r\n        output_path.mkdir(exist_ok=True)\r\n        \r\n        if method == "wget":\r\n            cmd = f"wget --recursive --page-requisites --convert-links --adjust-extension --no-parent --directory-prefix={output_path} {url}"\r\n        elif method == "wparc":\r\n            # \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 WordPress API\r\n            check_cmd = f"curl -s {url}/wp-json/wp/v2/"\r\n            result = subprocess.run(check_cmd, shell=True, capture_output=True)\r\n            if result.returncode == 0:\r\n                cmd = f"wparc {url} --output {output_path}"\r\n            else:\r\n                cmd = f"wget --recursive --page-requisites --convert-links --adjust-extension --no-parent --directory-prefix={output_path} {url}"\r\n        \r\n        self.run_command(cmd, f"\u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f \u0432\u0435\u0431-\u0441\u0430\u0439\u0442\u0430 {url}")\r\n    \r\n    def create_index(self):\r\n        """\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0438\u043d\u0434\u0435\u043a\u0441\u043d\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430"""\r\n        index = {\r\n            "project": self.project_name,\r\n            "date": datetime.now().isoformat(),\r\n            "components": []\r\n        }\r\n        \r\n        # \u0421\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u0439\r\n        for component_dir in self.output_dir.iterdir():\r\n            if component_dir.is_dir():\r\n                component_info = {\r\n                    "name": component_dir.name,\r\n                    "path": str(component_dir.relative_to(self.output_dir)),\r\n                    "size": sum(f.stat().st_size for f in component_dir.rglob(\'*\') if f.is_file()),\r\n                    "files": sum(1 for f in component_dir.rglob(\'*\') if f.is_file())\r\n                }\r\n                index["components"].append(component_info)\r\n        \r\n        index_file = self.output_dir / "index.json"\r\n        with open(index_file, \'w\', encoding=\'utf-8\') as f:\r\n            json.dump(index, f, indent=2, ensure_ascii=False)\r\n        \r\n        self.log(f"\u2713 \u0418\u043d\u0434\u0435\u043a\u0441 \u0441\u043e\u0437\u0434\u0430\u043d: {index_file}")\r\n    \r\n    def save_logs(self):\r\n        """\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u043b\u043e\u0433\u043e\u0432"""\r\n        log_file = self.output_dir / "workflow.log"\r\n        with open(log_file, \'w\', encoding=\'utf-8\') as f:\r\n            f.write(\'\\n\'.join(self.logs))\r\n        self.log(f"\u2713 \u041b\u043e\u0433\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b: {log_file}")\r\n\r\n# \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\r\nif __name__ == "__main__":\r\n    workflow = ArchiveWorkflow(\r\n        project_name="social-media-project",\r\n        output_dir="./archive-social"\r\n    )\r\n    \r\n    # \u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f Telegram\r\n    workflow.archive_telegram("channel_name", "tg_config.yaml")\r\n    \r\n    # \u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f \u0432\u0435\u0431-\u0441\u0430\u0439\u0442\u0430\r\n    workflow.archive_website("https://example.com", method="wparc")\r\n    \r\n    # \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0438\u043d\u0434\u0435\u043a\u0441\u0430\r\n    workflow.create_index()\r\n    \r\n    # \u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u043b\u043e\u0433\u043e\u0432\r\n    workflow.save_logs()\r\n    \r\n    print("Workflow \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d!")\n'})}),"\n",(0,o.jsx)(n.h3,{id:"workflow-3-\u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f-\u0440\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u0430\u044f-\u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f",children:"Workflow 3: \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0440\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u0430\u044f \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'#!/usr/bin/env python3\r\n# scheduled-archive-workflow.py\r\n\r\nimport schedule\r\nimport time\r\nimport subprocess\r\nfrom datetime import datetime\r\nimport json\r\n\r\ndef archive_api():\r\n    """\u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u0430\u044f \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f API"""\r\n    print(f"[{datetime.now()}] \u0417\u0430\u043f\u0443\u0441\u043a \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u0438 API...")\r\n    \r\n    # \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u043e\u0432\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445\r\n    result = subprocess.run(\r\n        "apibackuper estimate incremental -p my-api --since $(date -d \'7 days ago\' +%Y-%m-%d)",\r\n        shell=True,\r\n        capture_output=True,\r\n        text=True\r\n    )\r\n    \r\n    # \u041f\u0430\u0440\u0441\u0438\u043d\u0433 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\r\n    if "records" in result.stdout:\r\n        # \u0417\u0430\u043f\u0443\u0441\u043a \u0438\u043d\u043a\u0440\u0435\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u0438\r\n        subprocess.run("apibackuper run incremental -p my-api", shell=True)\r\n        print("\u2713 \u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f API \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430")\r\n    else:\r\n        print("\u041d\u043e\u0432\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e")\r\n\r\ndef archive_telegram_channels():\r\n    """\u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u0430\u044f \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f Telegram \u043a\u0430\u043d\u0430\u043b\u043e\u0432"""\r\n    print(f"[{datetime.now()}] \u0417\u0430\u043f\u0443\u0441\u043a \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u0438 Telegram...")\r\n    \r\n    channels = ["channel1", "channel2", "channel3"]\r\n    \r\n    for channel in channels:\r\n        subprocess.run(\r\n            f"tgarc download --target {channel} --output ./telegram-archive/{channel} --incremental",\r\n            shell=True\r\n        )\r\n    \r\n    print("\u2713 \u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f Telegram \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430")\r\n\r\ndef generate_report():\r\n    """\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043e\u0442\u0447\u0451\u0442\u0430 \u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0435 \u0430\u0440\u0445\u0438\u0432\u043e\u0432"""\r\n    print(f"[{datetime.now()}] \u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u043e\u0442\u0447\u0451\u0442\u0430...")\r\n    \r\n    # \u0421\u0431\u043e\u0440 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438\r\n    report = {\r\n        "date": datetime.now().isoformat(),\r\n        "archives": {}\r\n    }\r\n    \r\n    # \u0417\u0434\u0435\u0441\u044c \u043c\u043e\u0436\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0431\u043e\u0440 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438\r\n    # \u0438\u043b\u0438 \u0430\u043d\u0430\u043b\u0438\u0437 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u0430\u0440\u0445\u0438\u0432\u043e\u0432\r\n    \r\n    with open("archive-report.json", "w") as f:\r\n        json.dump(report, f, indent=2)\r\n    \r\n    print("\u2713 \u041e\u0442\u0447\u0451\u0442 \u0441\u043e\u0437\u0434\u0430\u043d")\r\n\r\n# \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f\r\nschedule.every().day.at("02:00").do(archive_api)\r\nschedule.every().day.at("03:00").do(archive_telegram_channels)\r\nschedule.every().sunday.at("04:00").do(generate_report)\r\n\r\nprint("\u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0449\u0438\u043a \u0437\u0430\u043f\u0443\u0449\u0435\u043d. \u041e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447...")\r\n\r\nwhile True:\r\n    schedule.run_pending()\r\n    time.sleep(60)\n'})}),"\n",(0,o.jsx)(n.h2,{id:"\u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430-\u043e\u0448\u0438\u0431\u043e\u043a",children:"\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043e\u0448\u0438\u0431\u043e\u043a"}),"\n",(0,o.jsx)(n.h3,{id:"retry-\u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c",children:"Retry \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'import time\r\nfrom functools import wraps\r\n\r\ndef retry(max_attempts=3, delay=5):\r\n    def decorator(func):\r\n        @wraps(func)\r\n        def wrapper(*args, **kwargs):\r\n            for attempt in range(max_attempts):\r\n                try:\r\n                    return func(*args, **kwargs)\r\n                except Exception as e:\r\n                    if attempt == max_attempts - 1:\r\n                        raise\r\n                    print(f"\u041f\u043e\u043f\u044b\u0442\u043a\u0430 {attempt + 1} \u043d\u0435 \u0443\u0434\u0430\u043b\u0430\u0441\u044c: {e}. \u041f\u043e\u0432\u0442\u043e\u0440 \u0447\u0435\u0440\u0435\u0437 {delay} \u0441\u0435\u043a...")\r\n                    time.sleep(delay)\r\n        return wrapper\r\n    return decorator\r\n\r\n@retry(max_attempts=3, delay=10)\r\ndef archive_with_retry(url):\r\n    subprocess.run(f"wget -r {url}", shell=True, check=True)\n'})}),"\n",(0,o.jsx)(n.h3,{id:"\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430-\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439",children:"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\r\n# check-dependencies.sh\r\n\r\ncheck_command() {\r\n    if ! command -v "$1" &> /dev/null; then\r\n        echo "\u2717 $1 \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d"\r\n        return 1\r\n    else\r\n        echo "\u2713 $1 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d"\r\n        return 0\r\n    fi\r\n}\r\n\r\nERRORS=0\r\n\r\ncheck_command wget || ERRORS=$((ERRORS + 1))\r\ncheck_command apibackuper || ERRORS=$((ERRORS + 1))\r\ncheck_command wparc || ERRORS=$((ERRORS + 1))\r\ncheck_command tgarc || ERRORS=$((ERRORS + 1))\r\ncheck_command filegetter || ERRORS=$((ERRORS + 1))\r\ncheck_command jq || ERRORS=$((ERRORS + 1))\r\n\r\nif [ $ERRORS -gt 0 ]; then\r\n    echo "\u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u043e $ERRORS \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u043e\u0432"\r\n    exit 1\r\nfi\r\n\r\necho "\u0412\u0441\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b"\n'})}),"\n",(0,o.jsx)(n.h2,{id:"\u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433-\u0438-\u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",children:"\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u0438 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"}),"\n",(0,o.jsx)(n.h3,{id:"\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435-\u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",children:"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'import logging\r\nfrom logging.handlers import RotatingFileHandler\r\n\r\ndef setup_logging(log_file="workflow.log"):\r\n    logger = logging.getLogger("archive_workflow")\r\n    logger.setLevel(logging.INFO)\r\n    \r\n    # \u0424\u0430\u0439\u043b\u043e\u0432\u044b\u0439 handler \u0441 \u0440\u043e\u0442\u0430\u0446\u0438\u0435\u0439\r\n    file_handler = RotatingFileHandler(\r\n        log_file,\r\n        maxBytes=10*1024*1024,  # 10 MB\r\n        backupCount=5\r\n    )\r\n    file_handler.setFormatter(\r\n        logging.Formatter(\'%(asctime)s - %(levelname)s - %(message)s\')\r\n    )\r\n    \r\n    # \u041a\u043e\u043d\u0441\u043e\u043b\u044c\u043d\u044b\u0439 handler\r\n    console_handler = logging.StreamHandler()\r\n    console_handler.setFormatter(\r\n        logging.Formatter(\'%(levelname)s - %(message)s\')\r\n    )\r\n    \r\n    logger.addHandler(file_handler)\r\n    logger.addHandler(console_handler)\r\n    \r\n    return logger\r\n\r\nlogger = setup_logging()\r\n\r\nlogger.info("\u0417\u0430\u043f\u0443\u0441\u043a workflow")\r\nlogger.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u0438")\n'})}),"\n",(0,o.jsx)(n.h2,{id:"\u043b\u0443\u0447\u0448\u0438\u0435-\u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438",children:"\u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"\u0418\u0434\u0435\u043c\u043f\u043e\u0442\u0435\u043d\u0442\u043d\u043e\u0441\u0442\u044c"}),": Workflow \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u043c \u0434\u043b\u044f \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0433\u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0430"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"\u041b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"}),": \u0412\u0435\u0434\u0438\u0442\u0435 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0435 \u043b\u043e\u0433\u0438 \u0432\u0441\u0435\u0445 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0438"}),": \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0439\u0442\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u044d\u0442\u0430\u043f\u0430"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043e\u0448\u0438\u0431\u043e\u043a"}),": \u041e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0439\u0442\u0435 \u043e\u0448\u0438\u0431\u043a\u0438 gracefully"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f"}),": \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0439\u0442\u0435 workflow \u0438 \u0435\u0433\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"\u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"}),": \u0422\u0435\u0441\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043d\u0430 \u043d\u0435\u0431\u043e\u043b\u044c\u0448\u0438\u0445 \u043e\u0431\u044a\u0451\u043c\u0430\u0445 \u043f\u0435\u0440\u0435\u0434 \u043f\u043e\u043b\u043d\u044b\u043c \u0437\u0430\u043f\u0443\u0441\u043a\u043e\u043c"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"\u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435-\u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b",children:"\u0421\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/kb/case-studies/multi-tool-archiving",children:"\u0410\u0440\u0445\u0438\u0432\u0430\u0446\u0438\u044f \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u043d\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/kb/instruments/ruarxive-tools",children:"\u0412\u0441\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b Ruarxive"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"/kb/instruments/downloaded-data/apibackuper",children:"APIBackuper \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f"})}),"\n"]})]})}function u(r={}){const{wrapper:n}={...(0,i.R)(),...r.components};return n?(0,o.jsx)(n,{...r,children:(0,o.jsx)(d,{...r})}):d(r)}},8453:(r,n,e)=>{e.d(n,{R:()=>s,x:()=>l});var t=e(6540);const o={},i=t.createContext(o);function s(r){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof r?r(n):{...n,...r}},[n,r])}function l(r){let n;return n=r.disableParentContext?"function"==typeof r.components?r.components(o):r.components||o:s(r.components),t.createElement(i.Provider,{value:n},r.children)}}}]);